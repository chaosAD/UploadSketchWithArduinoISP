This is a tutorial to program ATmega chip using avrdude through Arduino board.

0. Connect the Arduino board to the target MCU as follow:

	Arduino board        target MCU
	=============        ==========
	SS   (D10) 	     Reset		
	MOSI (D11)           MOSI 
	MISO (D12)	     MISO
	SCK  (D13)           SCK
	Gnd		     Gnd
	+5V                  +5V

1. Download ArduinoISP program into the MCU on the Arduino board. The program (.ino)
can be found under File->Examples->ArduinoISP.

2. Then select the approriate target board under Tools->Boards->???, where ??? is
the name of the target board.

3. Set the communication port (to upload the program to the target board) which the Arduino
board (preprogrammed with ArduinoISP) is listening to. (Note: this step is not needed
because the port must have been correctly set when uploading the ArduinoISP program
onto the Arduino board) 

4. Write a program for the target MCU and hit Sketch->Upload Using Programmer. Warning:
Do not click "Upload" because that will overwrite the ArduinoISP program on the
Arduino board! If you accidentally clicked it, then repeat steps 1-2 again. The following 
is a simple blinky and hello world! program. It assumes an LED is connected to the D8 pin. The
program sends "hello world!" message every 2 seconds and blink at the rate of once a second.
```
//int led = LED_BUILTIN;
int led = 8;

void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  pinMode(led, OUTPUT);
}

void loop() {
  // put your main code here, to run repeatedly:
  Serial.write(" hello world!\n");

  digitalWrite(led, HIGH);
  delay(1000);                       // wait for a second
  digitalWrite(led, LOW);
  delay(1000);                       // wait for a second
}
```
Another way to program the target board through Arduino is through manual
command-line-interface using `avrdude` program. In fact the Arduino IDE uses
`avrdude` to flash the MCU as well. If you use `Git Bash`, type:
```
avrdude -C "<path-to-avrdude-configuration-file>"				\
-cstk500v1 -patmega32u4  -PCOM3 -b19200 -Uflash:w:SerialPrint.ino.ino.leonardo.hex
```
where `<name-of-avrdude-conf>` is the path and the name of the avrdude configuration
file. The name is most probably be `avrdude.conf`. E.g.,
```
avrdude -C "/C/Program Files (x86)/Arduino/hardware/tools/avr/etc/avrdude.conf"	\
-cstk500v1 -patmega32u4  -PCOM3 -b19200 -Uflash:w:SerialPrint.ino.ino.leonardo.hex
```
If the location of the configuration is unknown, use a search tool to locate it.
Also the example assumes the `avrdude` is in the path. If it is not, type
```
export PATH="<path-to-avrdude>:$PATH"
```
where `<path-to-avrdude>` is the appropriate path on your system. E.g.,
```
export PATH="/C/Program Files (x86)/Arduino/hardware/tools/avr/bin:$PATH"
```
first. If the location is unknown, use the search tool to locate it. 
In the command above, the program for the target MCU is
```
SerialPrint.ino.ino.leonardo.hex
```
It might be a different name for your case (rename appropriately before issuing
the command). It is generated by clicking `Sketch->Export compiled Binary`. The
output hex file can be found in the same folder as the source file. To get
there, click `Sketch->Show Sketch Folder`.

I find it useful to enable verbosity for compilation and uploading program.
This will reveal how the Arduino IDE compiles and uploads the program. To do
that, click on `File->Preferences->Settings`. Then tick on `compilation` and
`upload` checkbox next to `Show verbosity output during:` option.

Note that you can also burn Arduino boatloader into a non-Arduino-preloaded or
a new MCU. To do that, make sure the target MCU is connected to the Arduino
board like the step 0 above, then click on `Tools->Burn Bootloader`.
This will allow the target MCU to be programmed directly the Arduino sketch
under Arduino IDE without Arduino board. However only a few ATmega MCU is
supported. Also, it requires USB-to-Serial converter if you use contemporary
PC which does not usually come with an RS-232 port. If it does, you still
need a voltage converter that converts -10V to +10V from the port to 0 to
+5V appropriate for the MCU.







